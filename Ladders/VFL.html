<script>
    async function fetchLadder() {
        try {
            const res = await fetch('https://raw.githubusercontent.com/Shrunk-Innovation-Lab/testsite/main/Ladders/VFLladder.json');
            const ladderData = await res.json();
            populateTable(ladderData);
            setLastUpdated();
        } catch (err) {
            console.error("âŒ Failed to load ladder.json:", err);
        }
    }

    function populateTable(ladderData) {
        const tableBody = document.getElementById('ladder-body');
        if (!tableBody) return;
        tableBody.innerHTML = '';

        ladderData.forEach((team, index) => {
            const played = team.P;
            const row = document.createElement('tr');
            row.className = 'table-row border-b transition-colors duration-200';
            row.style.borderColor = 'var(--border-color)';
            row.classList.add(index < 8 ? 'top-finalist' : 'border-transparent');

            row.innerHTML = `
                <td class="px-4 py-4 text-center font-medium" style="color: var(--text-secondary);">${team.POS}</td>
                <td class="px-6 py-4 font-semibold text-white whitespace-nowrap">${team.TEAM}</td>
                <td class="px-4 py-4 text-center" style="color: var(--text-secondary);">${played}</td>
                <td class="px-4 py-4 text-center" style="color: var(--text-secondary);">${team.W}</td>
                <td class="px-4 py-4 text-center" style="color: var(--text-secondary);">${team.L}</td>
                <td class="px-4 py-4 text-center" style="color: var(--text-secondary);">${team.D}</td>
                <td class="px-6 py-4 text-right font-bold" style="color: var(--accent-purple);">${team.PTS}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    function setLastUpdated() {
        const lastUpdatedDiv = document.getElementById('last-updated');
        if (!lastUpdatedDiv) return;
        const now = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        lastUpdatedDiv.textContent = `Last Updated: ${now.toLocaleDateString('en-AU', options)}`;
    }

    document.addEventListener('DOMContentLoaded', fetchLadder);
</script>
