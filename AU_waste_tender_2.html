<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tender Portal - Admin View</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      height: 100%;
    }
    html {
      height: 100%;
    }
    .gradient-bg {
      background: linear-gradient(135deg, #7c3aed 0%, #a78bfa 100%);
    }
    .splash-accent {
      background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);
    }
    .card-shadow {
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    }
    .admin-edit-field {
      width: 100%;
      padding: 0.5rem;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 0.875rem;
      transition: border-color 0.2s ease;
    }
    .admin-edit-field:focus {
      outline: none;
      border-color: #8b5cf6;
    }
    .admin-section {
      background-color: #f9fafb;
      padding: 1.5rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
      border: 2px dashed #d1d5db;
    }
    .admin-section:hover {
      border-color: #8b5cf6;
    }
    .admin-label {
      display: block;
      font-weight: 600;
      color: #374151;
      margin-bottom: 0.5rem;
      font-size: 0.875rem;
    }
    .photo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    .photo-item {
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      overflow: hidden;
      background-color: #ffffff;
      padding: 0.75rem;
      position: relative;
    }
    .photo-item img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 0.5rem;
    }
    .photo-placeholder {
      width: 100%;
      height: 150px;
      background-color: #e5e7eb;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #9ca3af;
      font-size: 0.875rem;
      margin-bottom: 0.5rem;
    }
    .delete-btn {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background-color: #ef4444;
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-weight: bold;
      font-size: 1.2rem;
      transition: background-color 0.2s ease;
    }
    .delete-btn:hover {
      background-color: #dc2626;
    }
    .add-photo-btn {
      border: 2px dashed #8b5cf6;
      background-color: #f5f3ff;
      border-radius: 12px;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .add-photo-btn:hover {
      background-color: #ede9fe;
      border-color: #7c3aed;
    }
    .tab-button {
      padding: 0.75rem 1.5rem;
      border-bottom: 3px solid transparent;
      font-weight: 500;
      transition: all 0.3s ease;
      cursor: pointer;
      background: none;
      border-top: none;
      border-left: none;
      border-right: none;
    }
    .tab-button:hover {
      background-color: rgba(0,0,0,0.05);
    }
    .tab-button.active {
      border-bottom-color: #8b5cf6;
      color: #8b5cf6;
    }
    .question-item {
      background-color: white;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1rem;
      position: relative;
    }
    .question-item:hover {
      border-color: #8b5cf6;
    }
    .site-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      overflow: hidden;
    }
    .site-table th,
    .site-table td {
      border-bottom: 1px solid #e5e7eb;
      border-right: 1px solid #e5e7eb;
      padding: 0.75rem;
      text-align: left;
    }
    .site-table th:last-child,
    .site-table td:last-child {
      border-right: none;
    }
    .site-table tr:last-child td {
      border-bottom: none;
    }
    .site-table th {
      background-color: #faf5ff;
      font-weight: 600;
      color: #374151;
    }
    .document-item {
      background-color: white;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1rem;
      position: relative;
    }
    .service-row-item {
      background-color: white;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1rem;
      position: relative;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body>
  <div id="app" class="w-full min-h-full"></div>
  <script>
    // Admin credentials - CHANGE THESE
    const ADMIN_CREDENTIALS = {
      username: "admin",
      password: "admin123"
    };

    let isAdmin = false;
    let activeTab = "settings";
    
    // Admin configuration stored in localStorage
    let adminConfig = {
      portal_title: "Tender Portal",
      client_name: "Cedar Pacific",
      tender_title: "Request for Waste Services Quotation",
      contact_name: "Nick Twining – Shrunk",
      contact_details: "M: 0418 854 628 | E: nick@shrunk.ai",
      form_endpoint: "https://formspree.io/f/YOUR_FORM_ID",
      primary_color: "#7c3aed",
      secondary_color: "#8b5cf6",
      
      // Customer details
      customer_overview: "Cedar Pacific is one of Australia's leading specialist investors and developers in purpose-built student accommodation (PBSA) and build-to-rent (BTR) assets. They own and manage a large national portfolio of residential properties, focused on long-term asset performance, operational efficiency, and sustainability outcomes.\n\nUniLodge operates as the on-site property and facilities manager for many of Cedar Pacific's student accommodation assets. Their teams manage the day-to-day operations, including tenant engagement, cleaning, and building services.",
      
      // Services overview
      services_overview: "Cedar Pacific's UniLodge-operated buildings generate high volumes of General Waste, Co-mingled Recycling, and Cardboard, driven by dense student occupancy and continuous daily turnover. Most buildings operate with 7-day-per-week waste collections.\n\nCo-mingled Recycling presents consistent challenges due to the chute system. High contamination rates are common. Contractors are expected to proactively identify contamination issues and work with Shrunk and Cedar Pacific to implement practical solutions.\n\nSites require occasional bulk dry waste, e-waste, and furniture disposal services in addition to regular collections. Clear communication, scheduling flexibility, and transparent pricing for these ad-hoc services are essential.",
      
      // Sites
      sites: [
        { name: "Unilodge Melbourne CBD", state: "VIC", address: "17-23 Wills Street, Melbourne, VIC, 3000" },
        { name: "Unilodge Melbourne Central", state: "VIC", address: "303 La Trobe Street, Melbourne, VIC, 3000" },
        { name: "Unilodge Victoria University", state: "VIC", address: "101 Ballarat Road, Footscray, VIC, 3011" },
        { name: "Unilodge Kensington", state: "NSW", address: "177-197 Anzac Parade, Kensington, NSW, 2033" }
      ],
      
      // Service requirements
      service_requirements: [
        "Early/overnight collection times preferred with provided keys/codes",
        "Drivers must move bins (~5-10m) to service location",
        "Low access rear-lift truck required for Unilodge Kensington (max height 4.3m)",
        "Trucks must have scales to weigh bins/waste with reporting capability",
        "SIFOT (Service in full on time) of 99% required"
      ],
      
      // Additional sections
      contamination_management: [
        "Operational cadence for discarding contaminated Co-Mingle as General Waste (same day collection)",
        "Monthly reporting on contamination events by day"
      ],
      
      reporting_requirements: "Monthly reporting on number of lifts, weight, and diversion metrics via portal or Excel file",
      
      commencement_term: "Contract commencement: On or after 01/02/2026\n\nContract term: 2 years with optional 1 year extension (2+1)\n\nPrice increases: Once per annum, capped increase (with justification), on anniversary of commencement",
      
      quotation_requirements: [
        "General Waste pricing based on 60kg per m³ density",
        "Co-Mingle pricing based on 30kg per m³ density",
        "Outline all additional fees: rental, fuel levies, futile fees, energy surcharges, weekend/holiday surcharges, overweight fees",
        "Providers with excessive additional fees will not be considered favorably"
      ],
      
      // Site photos
      site_photos: {
        "melbourne_cbd": [
          { url: "https://i.imgur.com/BteWMvZ.png", caption: "Building Entrance" },
          { url: "https://i.imgur.com/8uDbJhv.png", caption: "Waste Collection Area" }
        ],
        "melbourne_central": [
          { url: "https://i.imgur.com/7CJKzPR.png", caption: "Front Access" },
          { url: "https://i.imgur.com/7CJKzPR.png", caption: "Loading Dock" }
        ],
        "victoria_university": [
          { url: "https://i.imgur.com/krwtpkU.png", caption: "Site Overview" },
          { url: "https://i.imgur.com/XI9x0ct.png", caption: "Collection Point" },
          { url: "https://i.imgur.com/ISrH4Wl.png", caption: "Bin Area" }
        ],
        "kensington": [
          { url: "https://i.imgur.com/mUYtja3.png", caption: "Underground Access" },
          { url: "https://i.imgur.com/gUhXw4L.png", caption: "Waste Room" }
        ]
      },
      
      // Documents
      documents: [
        { title: "Cedar Pacific Supplier Code of Conduct", url: "https://drive.google.com/file/d/14GVTuUjH6wUZ58puTYgDIgqEkzS9gFWR/view?usp=sharing" },
        { title: "Cedar Pacific Procurement Policy", url: "https://example.com/procurement-policy.pdf" },
        { title: "Cedar Pacific Modern Slavery Policy", url: "https://example.com/modern-slavery-policy.pdf" },
        { title: "Cedar Pacific Sustainable Operations Policy", url: "https://example.com/sustainable-operations.pdf" }
      ],
      
      // Questionnaire questions
      questionnaire: [
        { id: "q1", section: "Modern Slavery", question: "Have you read, and do you agree to comply with our Modern Slavery Policy?", type: "yes_no" },
        { id: "q2", section: "Modern Slavery", question: "Does your company have any written policies and procedures relating to modern slavery, human rights, ethical trading and/or whistleblowing?", type: "yes_no_upload" },
        { id: "q3", section: "Modern Slavery", question: "How frequently are the above policies and procedures reviewed and updated (if any)?", type: "text" },
        { id: "q4", section: "Relationships", question: "Who are your direct suppliers and subcontractors for the supply of goods and/or services you will provide to us?", type: "text" },
        { id: "q5", section: "ESG", question: "Does your company have an ESG or Sustainability Policy?", type: "yes_no_upload" }
      ],
      
      // Quotation table - Core services
      core_services: [
        { state: "VIC", site: "Wills St", description: "11x1100L GW-7xW", stream: "General Waste", bin: "1100L", avg: "3.98", frequency: "Daily", days: "Mon,Tue,Wed,Thu,Fri,Sat,Sun" },
        { state: "VIC", site: "Wills St", description: "6x1100L CM-7xW", stream: "Comingle", bin: "1100L", avg: "2.06", frequency: "Daily", days: "Mon,Tue,Wed,Thu,Fri,Sat,Sun" },
        { state: "VIC", site: "Wills St", description: "1x1100L P&C-2xW", stream: "P&C", bin: "1100L", avg: "New", frequency: "Daily", days: "Tue,Fri" },
        { state: "VIC", site: "La Trobe", description: "10x1100L GW-7xW", stream: "General Waste", bin: "1100L", avg: "4.17", frequency: "Daily", days: "Mon,Tue,Wed,Thu,Fri,Sat,Sun" }
      ],
      
      // Additional services
      additional_services: [
        { state: "VIC", site: "Wills Street", service: "6-8m3 Dry Waste Skip" },
        { state: "VIC", site: "La Trobe Street", service: "6-8m3 Dry Waste Skip" },
        { state: "VIC", site: "Footscray", service: "6-8m3 Dry Waste Skip" },
        { state: "NSW", site: "Kensington", service: "6-8m3 Dry Waste Skip" }
      ]
    };

    function loadAdminConfig() {
      const stored = localStorage.getItem('admin_tender_config');
      if (stored) {
        adminConfig = { ...adminConfig, ...JSON.parse(stored) };
      }
    }

    function saveAdminConfig() {
      localStorage.setItem('admin_tender_config', JSON.stringify(adminConfig));
    }

    function initApp() {
      loadAdminConfig();
      renderApp();
    }

    function renderApp() {
      const app = document.getElementById('app');
      
      if (!isAdmin) {
        app.innerHTML = renderAdminLogin();
      } else {
        app.innerHTML = renderAdminPanel();
      }
    }

    function renderAdminLogin() {
      return `
        <div class="w-full min-h-full flex items-center justify-center" style="background-color: #f9fafb;">
          <div class="card-shadow rounded-lg p-8 w-full max-w-md" style="background-color: white;">
            <div class="text-center mb-6">
              <div class="splash-accent w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                </svg>
              </div>
              <h2 class="text-2xl font-bold text-gray-900">Admin Login</h2>
              <p class="text-gray-600 mt-2">Enter credentials to access admin panel</p>
            </div>

            <form onsubmit="handleAdminLogin(event)">
              <div class="mb-4">
                <label for="username" class="admin-label">Username</label>
                <input type="text" id="username" required class="admin-edit-field">
              </div>

              <div class="mb-6">
                <label for="password" class="admin-label">Password</label>
                <input type="password" id="password" required class="admin-edit-field">
              </div>

              <button type="submit" class="w-full text-white font-semibold py-3 rounded-lg transition-all" style="background-color: #8b5cf6;" onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
                Login
              </button>
            </form>
          </div>
        </div>
      `;
    }

    function renderAdminPanel() {
      return `
        <div class="w-full min-h-full" style="background-color: #f9fafb;">
          <div class="gradient-bg w-full py-6">
            <div class="max-w-7xl mx-auto px-6 flex justify-between items-center">
              <div>
                <h1 class="text-3xl font-bold text-white">Admin Panel - Tender Configuration</h1>
                <p class="text-white text-opacity-90 mt-1">Customize all aspects of the tender portal</p>
              </div>
              <button onclick="logout()" class="text-white bg-white bg-opacity-20 hover:bg-opacity-30 px-4 py-2 rounded-lg transition-all flex items-center">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                </svg>
                Logout
              </button>
            </div>
          </div>

          <div class="max-w-7xl mx-auto px-6 py-8">
            <div class="card-shadow rounded-lg" style="background-color: white;">
              <div class="border-b border-gray-200">
                <div class="flex space-x-2 px-6 overflow-x-auto">
                  <button class="tab-button ${activeTab === 'settings' ? 'active' : ''}" onclick="switchTab('settings')" style="color: ${activeTab === 'settings' ? adminConfig.secondary_color : '#374151'};">
                    Portal Settings
                  </button>
                  <button class="tab-button ${activeTab === 'requirements' ? 'active' : ''}" onclick="switchTab('requirements')" style="color: ${activeTab === 'requirements' ? adminConfig.secondary_color : '#374151'};">
                    Tender Requirements
                  </button>
                  <button class="tab-button ${activeTab === 'photos' ? 'active' : ''}" onclick="switchTab('photos')" style="color: ${activeTab === 'photos' ? adminConfig.secondary_color : '#374151'};">
                    Site Photos
                  </button>
                  <button class="tab-button ${activeTab === 'questionnaire' ? 'active' : ''}" onclick="switchTab('questionnaire')" style="color: ${activeTab === 'questionnaire' ? adminConfig.secondary_color : '#374151'};">
                    Questionnaire
                  </button>
                  <button class="tab-button ${activeTab === 'quotation' ? 'active' : ''}" onclick="switchTab('quotation')" style="color: ${activeTab === 'quotation' ? adminConfig.secondary_color : '#374151'};">
                    Quotation Table
                  </button>
                </div>
              </div>

              <div class="p-6">
                ${activeTab === 'settings' ? renderSettingsTab() : ''}
                ${activeTab === 'requirements' ? renderRequirementsTab() : ''}
                ${activeTab === 'photos' ? renderPhotosTab() : ''}
                ${activeTab === 'questionnaire' ? renderQuestionnaireTab() : ''}
                ${activeTab === 'quotation' ? renderQuotationTab() : ''}
              </div>
            </div>

            <div class="mt-6 flex justify-end">
              <button onclick="saveAllChanges()" class="text-white font-semibold py-3 px-8 rounded-lg transition-all flex items-center" style="background-color: #10b981;" onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Save All Changes
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function renderSettingsTab() {
      return `
        <div>
          <h2 class="text-2xl font-bold mb-6" style="color: #374151;">Portal Settings</h2>
          
          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Basic Information</h3>
            
            <div class="mb-4">
              <label class="admin-label">Portal Title</label>
              <input type="text" value="${adminConfig.portal_title}" onchange="updateConfig('portal_title', this.value)" class="admin-edit-field">
            </div>

            <div class="mb-4">
              <label class="admin-label">Client Name</label>
              <input type="text" value="${adminConfig.client_name}" onchange="updateConfig('client_name', this.value)" class="admin-edit-field">
            </div>

            <div class="mb-4">
              <label class="admin-label">Tender Title</label>
              <input type="text" value="${adminConfig.tender_title}" onchange="updateConfig('tender_title', this.value)" class="admin-edit-field">
            </div>

            <div class="mb-4">
              <label class="admin-label">Contact Name</label>
              <input type="text" value="${adminConfig.contact_name}" onchange="updateConfig('contact_name', this.value)" class="admin-edit-field">
            </div>

            <div class="mb-4">
              <label class="admin-label">Contact Details</label>
              <input type="text" value="${adminConfig.contact_details}" onchange="updateConfig('contact_details', this.value)" class="admin-edit-field">
            </div>

            <div class="mb-4">
              <label class="admin-label">Form Submission Endpoint (Formspree, Web3Forms, etc.)</label>
              <input type="text" value="${adminConfig.form_endpoint}" onchange="updateConfig('form_endpoint', this.value)" class="admin-edit-field">
            </div>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Color Scheme</h3>
            
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="admin-label">Primary Color</label>
                <div class="flex items-center">
                  <input type="color" value="${adminConfig.primary_color}" onchange="updateConfig('primary_color', this.value)" class="mr-2" style="width: 60px; height: 40px;">
                  <input type="text" value="${adminConfig.primary_color}" onchange="updateConfig('primary_color', this.value)" class="admin-edit-field">
                </div>
              </div>

              <div>
                <label class="admin-label">Secondary Color</label>
                <div class="flex items-center">
                  <input type="color" value="${adminConfig.secondary_color}" onchange="updateConfig('secondary_color', this.value)" class="mr-2" style="width: 60px; height: 40px;">
                  <input type="text" value="${adminConfig.secondary_color}" onchange="updateConfig('secondary_color', this.value)" class="admin-edit-field">
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function renderRequirementsTab() {
      return `
        <div>
          <h2 class="text-2xl font-bold mb-6" style="color: #374151;">Tender Requirements Content</h2>
          
          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Customer Overview</h3>
            <textarea rows="6" onchange="updateConfig('customer_overview', this.value)" class="admin-edit-field">${adminConfig.customer_overview}</textarea>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Services Overview</h3>
            <textarea rows="8" onchange="updateConfig('services_overview', this.value)" class="admin-edit-field">${adminConfig.services_overview}</textarea>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Sites</h3>
            <div id="sitesList">
              ${adminConfig.sites.map((site, index) => `
                <div class="question-item mb-3">
                  <div class="delete-btn" onclick="deleteSite(${index})" title="Delete site">×</div>
                  <div class="grid grid-cols-3 gap-3">
                    <div>
                      <label class="admin-label">Site Name</label>
                      <input type="text" value="${site.name}" onchange="updateSite(${index}, 'name', this.value)" class="admin-edit-field">
                    </div>
                    <div>
                      <label class="admin-label">State</label>
                      <input type="text" value="${site.state}" onchange="updateSite(${index}, 'state', this.value)" class="admin-edit-field">
                    </div>
                    <div>
                      <label class="admin-label">Address</label>
                      <input type="text" value="${site.address}" onchange="updateSite(${index}, 'address', this.value)" class="admin-edit-field">
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
            <button onclick="addSite()" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">+ Add Site</button>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Service Requirements</h3>
            <div id="serviceReqsList">
              ${adminConfig.service_requirements.map((req, index) => `
                <div class="flex items-center mb-2">
                  <input type="text" value="${req}" onchange="updateServiceRequirement(${index}, this.value)" class="admin-edit-field mr-2">
                  <button onclick="deleteServiceRequirement(${index})" class="px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">×</button>
                </div>
              `).join('')}
            </div>
            <button onclick="addServiceRequirement()" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">+ Add Requirement</button>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Contamination Management</h3>
            <div id="contaminationList">
              ${adminConfig.contamination_management.map((item, index) => `
                <div class="flex items-center mb-2">
                  <input type="text" value="${item}" onchange="updateContamination(${index}, this.value)" class="admin-edit-field mr-2">
                  <button onclick="deleteContamination(${index})" class="px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">×</button>
                </div>
              `).join('')}
            </div>
            <button onclick="addContamination()" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">+ Add Item</button>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Reporting Requirements</h3>
            <textarea rows="3" onchange="updateConfig('reporting_requirements', this.value)" class="admin-edit-field">${adminConfig.reporting_requirements}</textarea>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Commencement & Term</h3>
            <textarea rows="4" onchange="updateConfig('commencement_term', this.value)" class="admin-edit-field">${adminConfig.commencement_term}</textarea>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Quotation Requirements</h3>
            <div id="quotationReqsList">
              ${adminConfig.quotation_requirements.map((req, index) => `
                <div class="flex items-center mb-2">
                  <input type="text" value="${req}" onchange="updateQuotationRequirement(${index}, this.value)" class="admin-edit-field mr-2">
                  <button onclick="deleteQuotationRequirement(${index})" class="px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">×</button>
                </div>
              `).join('')}
            </div>
            <button onclick="addQuotationRequirement()" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">+ Add Requirement</button>
          </div>
        </div>
      `;
    }

    function renderPhotosTab() {
      const siteKeys = Object.keys(adminConfig.site_photos);
      
      return `
        <div>
          <h2 class="text-2xl font-bold mb-6" style="color: #374151;">Site Photos Management</h2>
          <p class="text-gray-600 mb-6">Manage photos for each site. Add photo URLs and captions.</p>

          ${siteKeys.map(siteKey => {
            const siteName = siteKey.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            return `
              <div class="admin-section">
                <h3 class="text-lg font-semibold mb-4" style="color: #374151;">${siteName}</h3>
                <div class="photo-grid">
                  ${adminConfig.site_photos[siteKey].map((photo, index) => `
                    <div class="photo-item">
                      <div class="delete-btn" onclick="deletePhoto('${siteKey}', ${index})" title="Delete photo">×</div>
                      ${photo.url ? `<img src="${photo.url}" alt="${photo.caption}">` : `<div class="photo-placeholder">No Image</div>`}
                      <div class="mt-2">
                        <label class="admin-label text-xs">Image URL</label>
                        <input type="text" value="${photo.url}" onchange="updatePhoto('${siteKey}', ${index}, 'url', this.value)" class="admin-edit-field text-xs mb-2" placeholder="https://...">
                        <label class="admin-label text-xs">Caption</label>
                        <input type="text" value="${photo.caption}" onchange="updatePhoto('${siteKey}', ${index}, 'caption', this.value)" class="admin-edit-field text-xs">
                      </div>
                    </div>
                  `).join('')}
                  <div class="add-photo-btn" onclick="addPhoto('${siteKey}')">
                    <svg class="w-12 h-12 text-purple-600 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    <span class="text-sm font-medium text-purple-600">Add Photo</span>
                  </div>
                </div>
              </div>
            `;
          }).join('')}

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Add New Site Photo Category</h3>
            <div class="flex items-center">
              <input type="text" id="newSiteKey" placeholder="e.g., sydney_campus" class="admin-edit-field mr-2" style="max-width: 300px;">
              <button onclick="addNewSiteCategory()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">Add Category</button>
            </div>
            <p class="text-xs text-gray-500 mt-2">Use lowercase with underscores (e.g., sydney_campus, perth_office)</p>
          </div>
        </div>
      `;
    }

    function renderQuestionnaireTab() {
      return `
        <div>
          <h2 class="text-2xl font-bold mb-6" style="color: #374151;">Supplier Questionnaire</h2>
          
          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Policy Documents</h3>
            <div id="documentsList">
              ${adminConfig.documents.map((doc, index) => `
                <div class="document-item">
                  <div class="delete-btn" onclick="deleteDocument(${index})" title="Delete document">×</div>
                  <div class="grid grid-cols-2 gap-3">
                    <div>
                      <label class="admin-label">Document Title</label>
                      <input type="text" value="${doc.title}" onchange="updateDocument(${index}, 'title', this.value)" class="admin-edit-field">
                    </div>
                    <div>
                      <label class="admin-label">Document URL</label>
                      <input type="text" value="${doc.url}" onchange="updateDocument(${index}, 'url', this.value)" class="admin-edit-field">
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
            <button onclick="addDocument()" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">+ Add Document</button>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Questionnaire Questions</h3>
            <div id="questionsList">
              ${adminConfig.questionnaire.map((q, index) => `
                <div class="question-item">
                  <div class="delete-btn" onclick="deleteQuestion(${index})" title="Delete question">×</div>
                  <div class="mb-3">
                    <label class="admin-label">Section</label>
                    <input type="text" value="${q.section}" onchange="updateQuestion(${index}, 'section', this.value)" class="admin-edit-field">
                  </div>
                  <div class="mb-3">
                    <label class="admin-label">Question</label>
                    <textarea rows="2" onchange="updateQuestion(${index}, 'question', this.value)" class="admin-edit-field">${q.question}</textarea>
                  </div>
                  <div>
                    <label class="admin-label">Answer Type</label>
                    <select onchange="updateQuestion(${index}, 'type', this.value)" class="admin-edit-field">
                      <option value="text" ${q.type === 'text' ? 'selected' : ''}>Text Area</option>
                      <option value="yes_no" ${q.type === 'yes_no' ? 'selected' : ''}>Yes/No</option>
                      <option value="yes_no_upload" ${q.type === 'yes_no_upload' ? 'selected' : ''}>Yes/No with Upload</option>
                    </select>
                  </div>
                </div>
              `).join('')}
            </div>
            <button onclick="addQuestion()" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">+ Add Question</button>
          </div>
        </div>
      `;
    }

    function renderQuotationTab() {
      return `
        <div>
          <h2 class="text-2xl font-bold mb-6" style="color: #374151;">Quotation Table Configuration</h2>
          
          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Core Services</h3>
            <div id="coreServicesList">
              ${adminConfig.core_services.map((service, index) => `
                <div class="service-row-item">
                  <div class="delete-btn" onclick="deleteCoreService(${index})" title="Delete service">×</div>
                  <div class="grid grid-cols-4 gap-2 mb-2">
                    <div>
                      <label class="admin-label text-xs">State</label>
                      <input type="text" value="${service.state}" onchange="updateCoreService(${index}, 'state', this.value)" class="admin-edit-field text-sm">
                    </div>
                    <div>
                      <label class="admin-label text-xs">Site</label>
                      <input type="text" value="${service.site}" onchange="updateCoreService(${index}, 'site', this.value)" class="admin-edit-field text-sm">
                    </div>
                    <div>
                      <label class="admin-label text-xs">Description</label>
                      <input type="text" value="${service.description}" onchange="updateCoreService(${index}, 'description', this.value)" class="admin-edit-field text-sm">
                    </div>
                    <div>
                      <label class="admin-label text-xs">Stream</label>
                      <input type="text" value="${service.stream}" onchange="updateCoreService(${index}, 'stream', this.value)" class="admin-edit-field text-sm">
                    </div>
                  </div>
                  <div class="grid grid-cols-4 gap-2">
                    <div>
                      <label class="admin-label text-xs">Bin Size</label>
                      <input type="text" value="${service.bin}" onchange="updateCoreService(${index}, 'bin', this.value)" class="admin-edit-field text-sm">
                    </div>
                    <div>
                      <label class="admin-label text-xs">Avg Collection</label>
                      <input type="text" value="${service.avg}" onchange="updateCoreService(${index}, 'avg', this.value)" class="admin-edit-field text-sm">
                    </div>
                    <div>
                      <label class="admin-label text-xs">Frequency</label>
                      <input type="text" value="${service.frequency}" onchange="updateCoreService(${index}, 'frequency', this.value)" class="admin-edit-field text-sm">
                    </div>
                    <div>
                      <label class="admin-label text-xs">Days (comma-separated)</label>
                      <input type="text" value="${service.days}" onchange="updateCoreService(${index}, 'days', this.value)" class="admin-edit-field text-sm" placeholder="Mon,Tue,Wed">
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
            <button onclick="addCoreService()" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">+ Add Core Service</button>
          </div>

          <div class="admin-section">
            <h3 class="text-lg font-semibold mb-4" style="color: #374151;">Additional Services</h3>
            <div id="additionalServicesList">
              ${adminConfig.additional_services.map((service, index) => `
                <div class="service-row-item">
                  <div class="delete-btn" onclick="deleteAdditionalService(${index})" title="Delete service">×</div>
                  <div class="grid grid-cols-3 gap-3">
                    <div>
                      <label class="admin-label text-xs">State</label>
                      <input type="text" value="${service.state}" onchange="updateAdditionalService(${index}, 'state', this.value)" class="admin-edit-field">
                    </div>
                    <div>
                      <label class="admin-label text-xs">Site</label>
                      <input type="text" value="${service.site}" onchange="updateAdditionalService(${index}, 'site', this.value)" class="admin-edit-field">
                    </div>
                    <div>
                      <label class="admin-label text-xs">Service Description</label>
                      <input type="text" value="${service.service}" onchange="updateAdditionalService(${index}, 'service', this.value)" class="admin-edit-field">
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
            <button onclick="addAdditionalService()" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">+ Add Additional Service</button>
          </div>
        </div>
      `;
    }

    // Admin login handler
    function handleAdminLogin(event) {
      event.preventDefault();
      
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      
      if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
        isAdmin = true;
        showMessage("Login successful!", "success");
        renderApp();
      } else {
        showMessage("Invalid credentials", "error");
      }
    }

    function logout() {
      isAdmin = false;
      activeTab = "settings";
      renderApp();
    }

    function switchTab(tab) {
      activeTab = tab;
      renderApp();
    }

    // Configuration update functions
    function updateConfig(key, value) {
      adminConfig[key] = value;
    }

    // Sites management
    function updateSite(index, field, value) {
      adminConfig.sites[index][field] = value;
    }

    function addSite() {
      adminConfig.sites.push({ name: "New Site", state: "VIC", address: "" });
      renderApp();
    }

    function deleteSite(index) {
      if (confirm('Are you sure you want to delete this site?')) {
        adminConfig.sites.splice(index, 1);
        renderApp();
      }
    }

    // Service requirements management
    function updateServiceRequirement(index, value) {
      adminConfig.service_requirements[index] = value;
    }

    function addServiceRequirement() {
      adminConfig.service_requirements.push("New requirement");
      renderApp();
    }

    function deleteServiceRequirement(index) {
      adminConfig.service_requirements.splice(index, 1);
      renderApp();
    }

    // Contamination management
    function updateContamination(index, value) {
      adminConfig.contamination_management[index] = value;
    }

    function addContamination() {
      adminConfig.contamination_management.push("New item");
      renderApp();
    }

    function deleteContamination(index) {
      adminConfig.contamination_management.splice(index, 1);
      renderApp();
    }

    // Quotation requirements management
    function updateQuotationRequirement(index, value) {
      adminConfig.quotation_requirements[index] = value;
    }

    function addQuotationRequirement() {
      adminConfig.quotation_requirements.push("New requirement");
      renderApp();
    }

    function deleteQuotationRequirement(index) {
      adminConfig.quotation_requirements.splice(index, 1);
      renderApp();
    }

    // Photo management
    function updatePhoto(siteKey, index, field, value) {
      adminConfig.site_photos[siteKey][index][field] = value;
      renderApp();
    }

    function addPhoto(siteKey) {
      adminConfig.site_photos[siteKey].push({ url: "", caption: "New Photo" });
      renderApp();
    }

    function deletePhoto(siteKey, index) {
      if (confirm('Are you sure you want to delete this photo?')) {
        adminConfig.site_photos[siteKey].splice(index, 1);
        renderApp();
      }
    }

    function addNewSiteCategory() {
      const key = document.getElementById('newSiteKey').value.trim().toLowerCase().replace(/\s+/g, '_');
      if (key && !adminConfig.site_photos[key]) {
        adminConfig.site_photos[key] = [];
        renderApp();
      } else if (adminConfig.site_photos[key]) {
        showMessage("This category already exists", "error");
      } else {
        showMessage("Please enter a valid category name", "error");
      }
    }

    // Document management
    function updateDocument(index, field, value) {
      adminConfig.documents[index][field] = value;
    }

    function addDocument() {
      adminConfig.documents.push({ title: "New Document", url: "" });
      renderApp();
    }

    function deleteDocument(index) {
      if (confirm('Are you sure you want to delete this document?')) {
        adminConfig.documents.splice(index, 1);
        renderApp();
      }
    }

    // Question management
    function updateQuestion(index, field, value) {
      adminConfig.questionnaire[index][field] = value;
    }

    function addQuestion() {
      adminConfig.questionnaire.push({
        id: `q${adminConfig.questionnaire.length + 1}`,
        section: "New Section",
        question: "New question?",
        type: "text"
      });
      renderApp();
    }

    function deleteQuestion(index) {
      if (confirm('Are you sure you want to delete this question?')) {
        adminConfig.questionnaire.splice(index, 1);
        renderApp();
      }
    }

    // Core services management
    function updateCoreService(index, field, value) {
      adminConfig.core_services[index][field] = value;
    }

    function addCoreService() {
      adminConfig.core_services.push({
        state: "VIC",
        site: "New Site",
        description: "Service Description",
        stream: "General Waste",
        bin: "1100L",
        avg: "0",
        frequency: "Daily",
        days: "Mon,Tue,Wed,Thu,Fri"
      });
      renderApp();
    }

    function deleteCoreService(index) {
      if (confirm('Are you sure you want to delete this service?')) {
        adminConfig.core_services.splice(index, 1);
        renderApp();
      }
    }

    // Additional services management
    function updateAdditionalService(index, field, value) {
      adminConfig.additional_services[index][field] = value;
    }

    function addAdditionalService() {
      adminConfig.additional_services.push({
        state: "VIC",
        site: "New Site",
        service: "Service Description"
      });
      renderApp();
    }

    function deleteAdditionalService(index) {
      if (confirm('Are you sure you want to delete this service?')) {
        adminConfig.additional_services.splice(index, 1);
        renderApp();
      }
    }

    // Save all changes
    function saveAllChanges() {
      saveAdminConfig();
      showMessage("All changes saved successfully!", "success");
    }

    function showMessage(message, type) {
      const color = type === "error" ? "#ef4444" : "#10b981";
      const toast = document.createElement('div');
      toast.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: ${color};
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        z-index: 10000;
        font-weight: 500;
      `;
      toast.textContent = message;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    // Initialize app
    document.addEventListener('DOMContentLoaded', initApp);
    if (document.readyState !== 'loading') {
      initApp();
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a9fd15e86f129c5',t:'MTc2NTA2NjQxNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
