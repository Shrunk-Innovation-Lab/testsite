<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Environmental Management Plan Feedback</title>

<style>
  :root{
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color: #111827;
  }

  /* ===== Animated PINK gradient background ===== */
  html, body { height:100%; }
  body{
    margin:0;
    min-height:100svh;
    background: linear-gradient(-45deg,
      #ff3d9a,
      #ff74c5,
      #ffd1ea,
      #ff55ad
    );
    background-size: 400% 400%;
    animation: gradientShift 14s ease-in-out infinite;
    -webkit-text-size-adjust: 100%;
  }

  @keyframes gradientShift{
    0%{ background-position: 0% 50%; }
    50%{ background-position: 100% 50%; }
    100%{ background-position: 0% 50%; }
  }

  @media (prefers-reduced-motion: reduce){
    body{ animation:none; background-position: 50% 50%; }
  }

  /* ===== Layout (single page scroll) ===== */
  .wrap{
    max-width: 720px;
    margin: 0 auto;
    padding: 18px;
    padding-bottom: calc(160px + env(safe-area-inset-bottom)); /* sticky + footer room */
  }

  .card{
    background: rgba(255,255,255,.92);
    border: 1px solid rgba(255,255,255,.55);
    backdrop-filter: blur(10px);
    border-radius:16px;
    padding: 20px;
    box-shadow: 0 8px 24px rgba(0,0,0,.10);
  }

  /* Brand header: logo above, centered, not squished */
  .brand{
    display:flex;
    flex-direction: column;
    align-items:center;
    text-align:center;
    gap: 12px;
    margin-bottom: 14px;
  }
  .brand img{
    width:auto;
    height:auto;
    max-width:160px;
    max-height:110px;
    object-fit:contain;
    display:block;
  }
  .brand-title{
    font-size: 18px;
    font-weight: 800;
    margin: 0;
    line-height: 1.2;
  }
  .brand-sub{
    font-size: 13px;
    color:#6b7280;
    margin: 4px 0 0;
    line-height: 1.25;
  }

  h1{ font-size: 20px; margin:0 0 12px; }
  .muted{ color:#6b7280; font-size: 14px; line-height: 1.45; }

  /* ‚úÖ MORE SPACING BETWEEN QUESTIONS */
  .question-block{
    margin: 30px 0 36px;
  }
  .question-block + .question-block{
    margin-top: 46px;
  }
  .divider{
    height:1px;
    background: rgba(209,213,219,.8);
    margin: 26px 0 10px;
  }

  .row{ margin: 16px 0; }
  label{ display:block; font-weight: 650; margin-bottom: 10px; line-height: 1.25; }

  input[type="text"], input[type="email"], textarea{
    width:100%;
    padding: 14px 14px;
    border-radius: 14px;
    border: 1px solid #d1d5db;
    font-size: 16px; /* prevents iOS zoom */
    box-sizing: border-box;
    background:#fff;
  }
  textarea{ min-height: 120px; resize: vertical; }

  /* ‚úÖ Pink focus (no blue) */
  input[type="text"]:focus,
  input[type="email"]:focus,
  textarea:focus{
    outline:none;
    border-color:#ff3d9a;
    box-shadow: 0 0 0 3px rgba(255,61,154,.25);
  }

  /* ‚úÖ Pink tap highlight (mobile) */
  input, textarea, button{
    -webkit-tap-highlight-color: rgba(255,61,154,.25);
  }

  .badge{
    background:#f3f4f6;
    border-radius: 999px;
    padding: 8px 10px;
    font-size: 13px;
    color:#374151;
    white-space: nowrap;
  }

  .error{
    color:#b91c1c;
    font-size: 14px;
    margin-top: 10px;
    display:none;
  }

  /* Slider cards */
  .panel{
    background:#f3f4f6;
    border-radius: 16px;
    padding: 16px;
  }
  .panel-row{
    display:flex;
    align-items:center;
    gap: 14px;
  }

  .emoji{
    font-size: 44px;
    line-height: 1;
    transition: transform .18s ease;
    flex: 0 0 auto;
  }
  .emoji.bump{ transform: scale(1.08); }

  input[type="range"]{
    -webkit-appearance:none;
    appearance:none;
    width:100%;
    height: 8px;
    border-radius: 999px;
    background:#d1d5db;
    outline:none;
    touch-action: pan-y;
  }
  input[type="range"]::-webkit-slider-thumb{
    -webkit-appearance:none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background:#111827;
    border: 3px solid #fff;
    box-shadow: 0 10px 26px rgba(0,0,0,.18);
  }
  input[type="range"]::-moz-range-thumb{
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background:#111827;
    border: 3px solid #fff;
    box-shadow: 0 10px 26px rgba(0,0,0,.18);
  }

  .scale-labels{
    display:flex;
    justify-content:space-between;
    font-size: 12px;
    color:#6b7280;
    margin-top: 10px;
    padding: 0 2px;
  }

  .value-text{
    font-weight: 650;
    margin-top: 12px;
    font-size: 16px;
    line-height: 1.25;
  }

  /* Fun Yes/No toggle */
  .toggle{
    width: 100%;
    max-width: 260px;
    height: 52px;
    background: #e5e7eb;
    border-radius: 999px;
    padding: 6px;
    display:flex;
    gap: 6px;
  }
  .toggle button{
    flex:1;
    border:0;
    border-radius: 999px;
    background: transparent;
    color:#111827;
    font-weight: 750;
    font-size: 16px;
    cursor:pointer;
    padding: 0;
  }
  .toggle button.active{
    background:#111827;
    color:#fff;
  }
  .hint{
    font-size: 13px;
    color:#6b7280;
    margin-top: 10px;
    line-height: 1.35;
  }

  /* Sticky bottom actions */
  .sticky{
    position: fixed;
    left:0; right:0; bottom:0;
    padding: 12px 14px calc(54px + env(safe-area-inset-bottom));
    background: rgba(246,247,249,.78);
    backdrop-filter: blur(10px);
    border-top: 1px solid rgba(209,213,219,.8);
    z-index: 10;
  }
  .sticky-inner{
    max-width: 720px;
    margin: 0 auto;
    display:flex;
    gap: 10px;
  }

  .btn{
    border:0;
    border-radius: 14px;
    padding: 14px 16px;
    font-size: 16px;
    font-weight: 700;
    cursor:pointer;
  }
  .btn.primary{ background:#111827; color:#fff; flex: 1; }
  .btn:disabled{ opacity: .6; cursor:not-allowed; }

  footer{
    position: fixed;
    left:0; right:0;
    bottom: 0;
    z-index: 11;
    padding: 10px 14px calc(10px + env(safe-area-inset-bottom));
    background: rgba(246,247,249,.78);
    backdrop-filter: blur(10px);
    border-top: 1px solid rgba(209,213,219,.8);
    font-size: 12px;
    color: #6b7280;
    text-align: center;
  }

  /* Thank you GIF ONLY */
  #thankyou{
    display:none;
    min-height: 100svh;
    align-items:center;
    justify-content:center;
    padding: 0 16px;
  }
  #thankyou img{
    width:100%;
    max-width: 420px;
    height:auto;
    display:block;
  }

  @media (min-width: 600px){
    .wrap{ padding: 24px; padding-bottom: 190px; }
    .card{ padding: 26px; }
    h1{ font-size: 22px; }
    .emoji{ font-size: 50px; }
    input[type="range"]::-webkit-slider-thumb{ width: 32px; height: 32px; }
    input[type="range"]::-moz-range-thumb{ width: 32px; height: 32px; }
  }
</style>
</head>

<body>
  <!-- THANK YOU (fullscreen gif only) -->
  <div id="thankyou">
    <img alt=""
      src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExbXVxNjAyMWN6ZjcyYnNjbDR5aHM1YzRhbzhkZG1taGhsNTloZ253ZiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/VGuKJjZOHvbTUtFNPT/giphy.gif">
  </div>

  <!-- FORM (single scroll page) -->
  <div class="wrap" id="formWrap">
    <div class="card" id="formCard">
      <header class="brand">
        <img src="https://i.imgur.com/iB983sa.png" alt="">
        <div>
          <p class="brand-title">Environmental Management Plan Feedback</p>
        </div>
      </header>

      <h4>Tell us what you think</h4>
      <p class="muted">Fill in your name, answer the questions and then hit Submit.</p>

      <div class="divider"></div>

      <!-- Name -->
      <div class="question-block" id="nameBlock">
        <label for="name">Name</label>
        <input id="name" type="text" placeholder="Your name" autocomplete="name" inputmode="text">
        <div class="error" id="errName">Please enter your name.</div>
      </div>

      <div class="divider"></div>

      <!-- Q1 -->
      <div class="question-block">
        <label for="q1">Q1. How confident do you feel in the current direction of the Environmental Management Plan?</label>
        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:12px;">
          <span class="badge">1 = Not confident</span>
          <span class="badge">5 = Very confident</span>
        </div>

        <div class="panel">
          <div class="panel-row">
            <div id="q1Face" class="emoji" aria-hidden="true">üòê</div>
            <div style="flex:1; min-width: 0;">
              <input id="q1" type="range" min="1" max="5" step="1" value="3" aria-label="Confidence 1 to 5">
              <div class="scale-labels" aria-hidden="true">
                <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
              </div>
            </div>
            <div class="badge">Score: <span id="q1Score">3</span></div>
          </div>
          <div class="value-text" id="q1Text">Neutral</div>
        </div>
      </div>

      <div class="divider"></div>

      <!-- Q2 -->
      <div class="question-block">
        <label for="q2">Q2. Which area gives you the most confidence?</label>

        <div class="panel">
          <div class="panel-row">
            <div id="q2Icon" class="emoji" aria-hidden="true">üéØ</div>
            <div style="flex:1; min-width: 0;">
              <input id="q2" type="range" min="1" max="5" step="1" value="1" aria-label="Area choice 1 to 5">
              <div class="scale-labels" aria-hidden="true">
                <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
              </div>
            </div>
            <div class="badge">Choice: <span id="q2Choice">1</span></div>
          </div>
          <div class="value-text" id="q2Text">Clarity of targets and direction</div>
        </div>
      </div>

      <div class="divider"></div>

      <!-- Working Group -->
      <div class="question-block">
        <label>Do you want to be in the working group?</label>

        <div class="panel">
          <div class="panel-row" style="align-items:flex-start;">
            <div id="wgIcon" class="emoji" aria-hidden="true">üòå</div>

            <div style="flex:1; min-width: 0;">
              <div class="toggle" role="group" aria-label="Working group yes or no">
                <button type="button" id="wgNo" class="active" aria-pressed="true">No</button>
                <button type="button" id="wgYes" aria-pressed="false">Yes</button>
              </div>
              <div class="hint" id="wgHint">All good ‚Äî no action needed.</div>
            </div>

            <div class="badge">Selected: <span id="wgValue">No</span></div>
          </div>

          <!-- ‚úÖ If YES: require email + optional areas -->
          <div class="row" id="wgContactRow" style="display:none; margin-top:18px;">
            <label for="wgEmail">Email address (so we can contact you)</label>
            <input id="wgEmail" type="email" placeholder="name@company.com" autocomplete="email" inputmode="email">
            <div class="error" id="errEmail">Please enter a valid email address.</div>
          </div>

          <div class="row" id="wgAreasRow" style="display:none; margin-top:18px;">
            <label for="wgAreas">Key areas you‚Äôd like to contribute to (optional)</label>
            <textarea id="wgAreas" placeholder="Type key areas you'd like to contribute to..."></textarea>
          </div>
        </div>

        <div class="error" id="errSubmit"></div>
      </div>

    </div>
  </div>

  <!-- Sticky submit -->
  <div class="sticky" id="stickyBar" role="region" aria-label="Form actions">
    <div class="sticky-inner">
      <button class="btn primary" id="submitBtn" type="button">Submit</button>
    </div>
  </div>

  <footer id="footerBar">2026 | Shrunk Innovation Group | All Rights Reserved</footer>

<script>
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwNocuTu1R50Ois2tclgihzrSjmIvWQ2ZFpMdTJ3sgkYuK5UhgMY6bZdb_VlVD26Ywm5A/exec";

  function bump(el){
    el.classList.add("bump");
    setTimeout(()=>el.classList.remove("bump"), 140);
  }

  // Q1
  const q1 = document.getElementById("q1");
  const q1Face = document.getElementById("q1Face");
  const q1Score = document.getElementById("q1Score");
  const q1Text = document.getElementById("q1Text");

  const q1States = {
    1: { face:"üòû", text:"Not confident" },
    2: { face:"üôÅ", text:"Low confidence" },
    3: { face:"üòê", text:"Neutral" },
    4: { face:"üôÇ", text:"Confident" },
    5: { face:"üòÑ", text:"Very confident" }
  };

  function updateQ1(val){
    q1Face.textContent = q1States[val].face;
    q1Text.textContent = q1States[val].text;
    q1Score.textContent = val;
    bump(q1Face);
  }
  updateQ1(q1.value);
  q1.addEventListener("input", e => updateQ1(e.target.value));

  // Q2
  const q2 = document.getElementById("q2");
  const q2Icon = document.getElementById("q2Icon");
  const q2Choice = document.getElementById("q2Choice");
  const q2Text = document.getElementById("q2Text");

  const areaStates = {
    1: { icon:"üéØ", text:"Clarity of targets and direction" },
    2: { icon:"‚öñÔ∏è", text:"Balance of impact, cost, effort, and time" },
    3: { icon:"üìã", text:"Initiative prioritisation" },
    4: { icon:"üß≠", text:"Delivery pathway and governance" },
    5: { icon:"ü§ù", text:"Stakeholder involvement" }
  };

  function updateQ2(val){
    q2Icon.textContent = areaStates[val].icon;
    q2Text.textContent = areaStates[val].text;
    q2Choice.textContent = val;
    bump(q2Icon);
  }
  updateQ2(q2.value);
  q2.addEventListener("input", e => updateQ2(e.target.value));

  // Working group
  let workingGroup = "No";
  const wgNoBtn = document.getElementById("wgNo");
  const wgYesBtn = document.getElementById("wgYes");
  const wgIcon = document.getElementById("wgIcon");
  const wgValue = document.getElementById("wgValue");
  const wgHint = document.getElementById("wgHint");

  const wgContactRow = document.getElementById("wgContactRow");
  const wgEmail = document.getElementById("wgEmail");
  const errEmail = document.getElementById("errEmail");

  const wgAreasRow = document.getElementById("wgAreasRow");
  const wgAreas = document.getElementById("wgAreas");

  function isValidEmail(email){
    // good-enough client validation
    return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(email.trim());
  }

  function setWG(value){
    workingGroup = value;
    const yes = value === "Yes";

    wgNoBtn.classList.toggle("active", !yes);
    wgYesBtn.classList.toggle("active", yes);
    wgNoBtn.setAttribute("aria-pressed", String(!yes));
    wgYesBtn.setAttribute("aria-pressed", String(yes));

    wgValue.textContent = value;

    if (yes){
      wgIcon.textContent = "üôã";
      wgHint.textContent = "Awesome! add your email so we can contact you and areas you are interested in specifically";
      wgContactRow.style.display = "block";
      wgAreasRow.style.display = "block";
    } else {
      wgIcon.textContent = "üòå";
      wgHint.textContent = "All good ‚Äî no action needed.";
      wgContactRow.style.display = "none";
      wgAreasRow.style.display = "none";
      errEmail.style.display = "none";
      wgEmail.value = "";
      wgAreas.value = "";
    }
    bump(wgIcon);
  }

  wgNoBtn.addEventListener("click", ()=> setWG("No"));
  wgYesBtn.addEventListener("click", ()=> setWG("Yes"));
  setWG("No");

  // Submit
  const nameEl = document.getElementById("name");
  const errName = document.getElementById("errName");
  const errSubmit = document.getElementById("errSubmit");
  const submitBtn = document.getElementById("submitBtn");

  const thankyou = document.getElementById("thankyou");
  const formWrap = document.getElementById("formWrap");
  const stickyBar = document.getElementById("stickyBar");
  const footerBar = document.getElementById("footerBar");

  function showThankYou(){
    formWrap.style.display = "none";
    stickyBar.style.display = "none";
    footerBar.style.display = "none";
    thankyou.style.display = "flex";
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  function scrollToEl(el){
    el.scrollIntoView({ behavior:"smooth", block:"center" });
  }

  submitBtn.addEventListener("click", async ()=> {
    errSubmit.style.display = "none";

    const name = nameEl.value.trim();
    if (!name){
      errName.style.display = "block";
      nameEl.focus({ preventScroll: true });
      scrollToEl(document.getElementById("nameBlock"));
      return;
    }
    errName.style.display = "none";

    if (workingGroup === "Yes"){
      const email = wgEmail.value.trim();
      if (!isValidEmail(email)){
        errEmail.style.display = "block";
        wgEmail.focus({ preventScroll: true });
        scrollToEl(wgContactRow);
        return;
      }
      errEmail.style.display = "none";
    } else {
      errEmail.style.display = "none";
    }

    const payload = {
      name,
      q1_confidence: q1.value,
      q2_area: areaStates[q2.value].text,
      working_group: workingGroup,
      working_group_email: (workingGroup === "Yes") ? wgEmail.value.trim() : "",
      working_group_areas: (workingGroup === "Yes") ? wgAreas.value.trim() : ""
    };

    submitBtn.disabled = true;
    submitBtn.textContent = "Submitting...";

    try{
      const fd = new FormData();
      Object.entries(payload).forEach(([k,v]) => fd.append(k, v));
      await fetch(WEB_APP_URL, { method:"POST", mode:"no-cors", body: fd });
      showThankYou();
    } catch(e){
      errSubmit.textContent = "Submit failed: " + (e.message || e);
      errSubmit.style.display = "block";
      window.scrollTo({ top: 0, behavior: "smooth" });
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = "Submit";
    }
  });
</script>
</body>
</html>
